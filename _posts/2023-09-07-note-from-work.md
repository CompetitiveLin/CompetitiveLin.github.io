---
title: Note from Work
categories: []
tags: [backend]
date: 2023-09-07T10:41:22+800
last_modified_at: 
pin: false
---

1. Grafana 的数据显示会五分钟自动补全。当向 Prometheus 中插入某个时间戳的值时，其值会延续五分钟。

2. K8S 中的 Sidecar 模式：通常情况下一个 Pod 只包含一个容器，但是 Sidecar 模式是指为主容器**提供额外功能（例如监控）** 从而将其他容器加入到同一个 Pod 中。再例如[ Istio 实现 Sidecar 自动注入](https://juejin.cn/post/6951567887664414757)。

3. Federated cluster，联邦集群

  ## Nacos 的 AP 和 CP 模式

  CAP 定理：分布式系统只能交付以下三个所需特性中的两个特性：一致性、可用性和分区容错性。其中一致性指的是所有客户端可以同时看到相同的数据，无论它们连接到哪个节点。每当数据写入一个节点时，就必须立即将其转发或复制到系统中的所有其他节点；可用性指的是可用性表示发出数据请求的任何客户端都会得到响应，即使一个或多个节点宕机。 分区容错性指无论系统中节点之间的通信出现多少故障，集群都必须持续工作。
  - C（Consistency）：一致性
  - A（Availability）：可用性
  - P（Partition tolerance）：分区容错性

Nacos集群默认支持AP原则（即不支持数据一致性，支持服务注册的临时实例），但也可切换至CP原则（支持服务注册的永久实例）。

MongoDB 是一种 CP 数据存储——它通过牺牲可用性、保持一致性来解决网络分区问题。

临时实例和持久化实例的区别：
- 持久化实例健康检查后会被标记为不健康，而临时实例会直接从列表中删除。