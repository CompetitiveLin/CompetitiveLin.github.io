---
title: ElasticSearch
categories: []
tags: []
date: 2023-08-10T15:08:32+800
last_modified_at: 
pin: false
---

Elasticsearch是基于 Lucene 架构实现的分布式、海量数据的存储分析引擎，其中 Lucene 最主要的**倒排索引结构**，赋予了ES全文检索、模糊匹配、联合索引查询等等快速检索文档数据的能力，使得ES在这些查询的应用场景下优于数据库。

倒排索引：被用来存储在全文搜索下某个单词在一个文档或者一组文档中的存储位置的映射。

基本概念：

1. Cluster，集群。一个集群包含多个节点，对外提供服务。
2. Node，节点。一个节点运行在一个独立的环境或虚拟机上，一个节点可以包含多个分片，一个索引由多个分片组成
3. Shard，分片。（Primary Shard 和 Replica Shard）
4. Index，索引，相当于mysql中的库。
5. Type，类型，一个索引可以对应一个或者多个类型。（ES6.0后被废弃，ES7完全删除）
6. Mapping，映射，相当于表结构。
7. Document，文档，相当于行。
8. Field，字段，相当于列。

分片与副本的区别在于：
- 当分片设置为5，数据量为30G时，ES会将数据平均分配到5个分片上，每个分片6G数据。进行数据查询时，ES会把查询发送给每个分片，最后将结果组合在一起。目的是保障查询的高效性。
- 副本是对分片的数据进行复制，目的是保障数据的高可靠性，防止丢失。

查询语句的filter比bool的效率高！

Ingest pipeline 可以在数据存入ES之前对数据进行转换，例如转小写，增加字段等。